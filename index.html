document.getElementById("faltaForm").addEventListener("submit", async function (event) {
  event.preventDefault();
  
  // Mostrar loading
  const button = event.target.querySelector("button");
  const originalText = button.textContent;
  button.textContent = "Enviando...";
  button.disabled = true;

  try {
    const formData = new FormData(event.target);
    const params = new URLSearchParams();
    
    params.append("nome", formData.get("nome"));
    params.append("data", formData.get("data"));
    params.append("status", formData.get("status"));
    
    // URL do seu script DEPLOYADO RECENTEMENTE
    const scriptUrl = "https://script.google.com/macros/s/AKfycbyiuOD3mv12cXVLtTr8JaEQNg5iav0M8h4dg5czklReJQTd_5FNZLmNANqQutSXA7nqiA/exec";
    
    // Solução alternativa com proxy CORS se necessário
    // const proxyUrl = "https://corsproxy.io/?";
    // const fullUrl = proxyUrl + encodeURIComponent(scriptUrl);
    
    const response = await fetch(scriptUrl, {
      method: "POST",
      headers: {
        "Content-Type": "application/x-www-form-urlencoded",
      },
      body: params.toString(),
      mode: "no-cors" // Só use isso se entender as limitações
    });
    
    // Se usar mode: "no-cors", você não poderá ler a resposta
    // Mas o dado será enviado para a planilha
    
    alert("Dados enviados com sucesso! Verifique a planilha.");
    event.target.reset();
    
  } catch (err) {
    console.error("Erro:", err);
    alert("Erro ao enviar: " + err.message);
  } finally {
    button.textContent = originalText;
    button.disabled = false;
  }
});
